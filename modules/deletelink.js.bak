const config = require("../config/config.json");
let newdaste = new Date();

module.exports.run = async (message) => {
    try{
        let reg = new RegExp("(https?:\/\/(?:www\.|(?!www))[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|www\.[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|https?:\/\/(?:www\.|(?!www))[a-zA-Z0-9]\.[^\s]{2,}|www\.[a-zA-Z0-9]\.[^\s]{2,})");
        if(message.channel.id !== config.delLinkInclusion) return;
        //if(message.member.hasPermission("EMBED_LINKS")) return;
	if(message.member.roles.some(role => role.id === config.boosterrole)) return;
        if(message.member.roles.some(role => role.id === config.allowlinkrole)) return;
        if(message.content.match(reg) != null && message.content.match(reg).length > 0){
            message.channel.fetchMessage(message.id).then(async msg => {
                if(msg) msg.delete();
            })
        }
    }catch(err){
        console.error(`[${newdate}]` + err);
    }
};
